<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 600" width="1000" height="600">
  <!-- Background -->
  <rect width="1000" height="600" fill="#f8f9fa" rx="10" ry="10"/>
  
  <!-- Title -->
  <text x="500" y="40" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold" fill="#333">SQL Chat Assistant - Query Processing Workflow</text>
  
  <!-- Workflow Steps -->
  <!-- User Input -->
  <rect x="50" y="100" width="160" height="60" rx="30" ry="30" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
  <text x="130" y="135" font-family="Arial" font-size="16" text-anchor="middle" fill="#0d47a1">User Question</text>
  
  <!-- API Processing -->
  <rect x="270" y="100" width="160" height="60" rx="30" ry="30" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
  <text x="350" y="135" font-family="Arial" font-size="16" text-anchor="middle" fill="#1b5e20">API Endpoint</text>
  
  <!-- Task Creation -->
  <rect x="490" y="100" width="160" height="60" rx="30" ry="30" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
  <text x="570" y="135" font-family="Arial" font-size="16" text-anchor="middle" fill="#e65100">Create Task</text>
  
  <!-- Task Processing -->
  <rect x="710" y="100" width="160" height="60" rx="30" ry="30" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2"/>
  <text x="790" y="135" font-family="Arial" font-size="16" text-anchor="middle" fill="#4a148c">Task Processing</text>
  
  <!-- LangGraph Workflow -->
  <rect x="200" y="220" width="600" height="280" rx="10" ry="10" fill="#fffde7" stroke="#fbc02d" stroke-width="2"/>
  <text x="500" y="250" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold" fill="#f57f17">LangGraph Workflow</text>
  
  <!-- Choose Tables -->
  <rect x="250" y="280" width="140" height="50" rx="5" ry="5" fill="#fff9c4" stroke="#fdd835" stroke-width="1"/>
  <text x="320" y="310" font-family="Arial" font-size="14" text-anchor="middle" fill="#f57f17">Choose Tables</text>
  
  <!-- Get DDLs -->
  <rect x="430" y="280" width="140" height="50" rx="5" ry="5" fill="#fff9c4" stroke="#fdd835" stroke-width="1"/>
  <text x="500" y="310" font-family="Arial" font-size="14" text-anchor="middle" fill="#f57f17">Get DDLs</text>
  
  <!-- Generate SQL -->
  <rect x="610" y="280" width="140" height="50" rx="5" ry="5" fill="#fff9c4" stroke="#fdd835" stroke-width="1"/>
  <text x="680" y="310" font-family="Arial" font-size="14" text-anchor="middle" fill="#f57f17">Generate SQL</text>
  
  <!-- Execute SQL -->
  <rect x="250" y="380" width="140" height="50" rx="5" ry="5" fill="#fff9c4" stroke="#fdd835" stroke-width="1"/>
  <text x="320" y="410" font-family="Arial" font-size="14" text-anchor="middle" fill="#f57f17">Execute SQL</text>
  
  <!-- Format Results -->
  <rect x="430" y="380" width="140" height="50" rx="5" ry="5" fill="#fff9c4" stroke="#fdd835" stroke-width="1"/>
  <text x="500" y="410" font-family="Arial" font-size="14" text-anchor="middle" fill="#f57f17">Format Results</text>
  
  <!-- Suggest Followups -->
  <rect x="610" y="380" width="140" height="50" rx="5" ry="5" fill="#fff9c4" stroke="#fdd835" stroke-width="1"/>
  <text x="680" y="410" font-family="Arial" font-size="14" text-anchor="middle" fill="#f57f17">Suggest Followups</text>
  
  <!-- Return Results -->
  <rect x="270" y="520" width="160" height="60" rx="30" ry="30" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
  <text x="350" y="555" font-family="Arial" font-size="16" text-anchor="middle" fill="#1b5e20">Return Results</text>
  
  <!-- Display to User -->
  <rect x="490" y="520" width="160" height="60" rx="30" ry="30" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
  <text x="570" y="555" font-family="Arial" font-size="16" text-anchor="middle" fill="#0d47a1">Display to User</text>
  
  <!-- Update Session -->
  <rect x="710" y="520" width="160" height="60" rx="30" ry="30" fill="#ffebee" stroke="#f44336" stroke-width="2"/>
  <text x="790" y="555" font-family="Arial" font-size="16" text-anchor="middle" fill="#b71c1c">Update Session</text>
  
  <!-- Connections -->
  <!-- Main Flow -->
  <path d="M210 130 L270 130" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M430 130 L490 130" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M650 130 L710 130" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- To LangGraph -->
  <path d="M790 160 L790 220" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- LangGraph Flow -->
  <path d="M390 305 L430 305" stroke="#f57f17" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M570 305 L610 305" stroke="#f57f17" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M680 330 L680 355 L320 355 L320 380" stroke="#f57f17" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M390 405 L430 405" stroke="#f57f17" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M570 405 L610 405" stroke="#f57f17" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- To Results -->
  <path d="M500 440 L500 475 L350 475 L350 520" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M350 580 L490 550" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M570 580 L710 550" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Cache Check -->
  <path d="M350 100 L350 70 L500 70 L500 100" stroke="#333" stroke-width="2" stroke-dasharray="5,5" fill="none" marker-end="url(#arrowhead)"/>
  <text x="425" y="60" font-family="Arial" font-size="12" fill="#333">Cache Check</text>
  
  <!-- Error Handling -->
  <path d="M320 430 L320 460 L220 460 L220 380 L250 380" stroke="#e53935" stroke-width="2" stroke-dasharray="5,5" fill="none" marker-end="url(#arrowhead)"/>
  <text x="180" y="425" font-family="Arial" font-size="12" fill="#b71c1c">Error Correction</text>
  
  <!-- External LLM API -->
  <path d="M320 280 L160 280" stroke="#9c27b0" stroke-width="2" stroke-dasharray="5,5" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M680 280 L840 280" stroke="#9c27b0" stroke-width="2" stroke-dasharray="5,5" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M680 380 L840 380" stroke="#9c27b0" stroke-width="2" stroke-dasharray="5,5" fill="none" marker-end="url(#arrowhead)"/>
  <rect x="100" y="260" width="120" height="40" rx="5" ry="5" fill="#f3e5f5" stroke="#9c27b0" stroke-width="1"/>
  <text x="160" y="285" font-family="Arial" font-size="12" text-anchor="middle" fill="#4a148c">LLM API Call</text>
  <rect x="840" y="260" width="120" height="40" rx="5" ry="5" fill="#f3e5f5" stroke="#9c27b0" stroke-width="1"/>
  <text x="900" y="285" font-family="Arial" font-size="12" text-anchor="middle" fill="#4a148c">LLM API Call</text>
  <rect x="840" y="360" width="120" height="40" rx="5" ry="5" fill="#f3e5f5" stroke="#9c27b0" stroke-width="1"/>
  <text x="900" y="385" font-family="Arial" font-size="12" text-anchor="middle" fill="#4a148c">LLM API Call</text>
  
  <!-- Database Access -->
  <path d="M320 430 L320 460 L100 460" stroke="#f44336" stroke-width="2" stroke-dasharray="5,5" fill="none" marker-end="url(#arrowhead)"/>
  <rect x="40" y="440" width="120" height="40" rx="5" ry="5" fill="#ffebee" stroke="#f44336" stroke-width="1"/>
  <text x="100" y="465" font-family="Arial" font-size="12" text-anchor="middle" fill="#b71c1c">Database Access</text>
  
  <!-- Arrow Marker -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>
  
  <!-- Legend -->
  <rect x="800" y="520" width="15" height="15" fill="#e3f2fd" stroke="#2196f3" stroke-width="1"/>
  <text x="820" y="532" font-family="Arial" font-size="12" fill="#333">User Interface</text>
  
  <rect x="800" y="540" width="15" height="15" fill="#e8f5e9" stroke="#4caf50" stroke-width="1"/>
  <text x="820" y="552" font-family="Arial" font-size="12" fill="#333">API Layer</text>
  
  <rect x="800" y="560" width="15" height="15" fill="#fff3e0" stroke="#ff9800" stroke-width="1"/>
  <text x="820" y="572" font-family="Arial" font-size="12" fill="#333">Task Processing</text>
  
  <rect x="920" y="520" width="15" height="15" fill="#fffde7" stroke="#fbc02d" stroke-width="1"/>
  <text x="940" y="532" font-family="Arial" font-size="12" fill="#333">LangGraph</text>
  
  <rect x="920" y="540" width="15" height="15" fill="#f3e5f5" stroke="#9c27b0" stroke-width="1"/>
  <text x="940" y="552" font-family="Arial" font-size="12" fill="#333">LLM Integration</text>
  
  <rect x="920" y="560" width="15" height="15" fill="#ffebee" stroke="#f44336" stroke-width="1"/>
  <text x="940" y="572" font-family="Arial" font-size="12" fill="#333">Database Access</text>
</svg>